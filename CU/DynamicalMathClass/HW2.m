clear
clc

% ------------------------------------------------------------------------
%%% 2.14
% ------------------------------------------------------------------------
% x0 = [1;1;0];
% A = [-1 0 0; 0 2 -4; 1 4 2];
% [v, e] = eig(A);
% 
% P = [-v(:,3), v(:,1), v(:,2)]
% 
% LAM = [e(3,3) 0 0; 0 e(1,1) 0; 0 0 e(2,2)]
% 
% S = P*LAM*inv(P)
% 
% syms t real
% 
% e_ts = P*expm(LAM.*t)*inv(P);
% 
% e_ts = simplify(e_ts)
% 
% e_ts*x0

% ------------------------------------------------------------------------
%%% 2.15 a
% ------------------------------------------------------------------------
% syms x t real
% p = (-1-x)*(3-x) + 8;
% collect(p,x)
% 
% A = [-1 -2; 4 3];
% [v, e] = eig(A);
% 
% P = v;
% inv(P)
% 
% LAM = e;
% 
% S = P*LAM*inv(P)
% e_tL = [exp(LAM(1,1).*t) 0; 0 exp(LAM(2,2).*t)];
% % e_ts = P*expm(LAM.*t)*inv(P)
% e_ts = P*e_tL*inv(P);
% e_ts = simplify(e_ts);
% 
% e_ts = vpa(e_ts,4)

% ------------------------------------------------------------------------
%%% 2.15 f
% ------------------------------------------------------------------------
% syms x t real
% p = (-1-x)*(3-x) + 8;
% collect(p,x);
% 
% A = [-2 -1 1; 0 -2 2; 0 0 -2];
% [v, e] = eig(A);
% 
% v = [1;0;0];
% e = -2;
% 
% P = v;
% 
% S = inv(P'*P)*(P'*A*P)*eye(3);
% N = A-S;
% 
% expm(S.*t)*expm(N.*t)

% ------------------------------------------------------------------------
%%% 2.19
% ------------------------------------------------------------------------

syms t real
A = [1 t; 0 -1];
B = [t .5*t^2; 0 -t];

[vA,eA] = eig(A);
[vB,eB] = eig(B);

P_A = vA;
inv(P_A);
LAM_A = eA;

S_A = P_A*LAM_A*inv(P_A);

e_ta = expm(S_A.*t)

P_B = vB
inv(P_B);
LAM_B = eB;

S_B = P_B*LAM_B*inv(P_B)

e_tb = expm(S_B.*t)

























