



clear
clc

mu = 1e-2;
R2n = 0.14;
x = 1.1;
y = 0.02245;
z = 0.204;
r = sqrt((x-1+mu)^2 + y^2 + z^2);
J2s = 0.0134;
C22s = 0.02345;

% ddx_hand = (-mu/r^3 + ((3*mu*R*R*J2)/(2*r^5))*(5*z*z/(r^2) -1) + ((3*mu*R*R*C22)/((x^2+y^2)*r^3))*(2 - 2*(x^2-y^2)/(x^2+y^2) - (3*(x^2-y^2) + 2*z*z)/(r^2) + 2*z*z*(x^2-y^2)/((x^2+y^2)*r*r) + (5*z*z*(x^2-y^2))/(r^4)))*x;
% ddy_hand = (-mu/r^3 + ((3*mu*R*R*J2)/(2*r^5))*(5*z*z/(r^2) -1) + ((3*mu*R*R*C22)/((x^2+y^2)*r^3))*(-2 - 2*(x^2-y^2)/(x^2+y^2) - (3*(x^2-y^2) - 2*z*z)/(r^2) + 2*z*z*(x^2-y^2)/((x^2+y^2)*r*r) + (5*z*z*(x^2-y^2))/(r^4)))*y;
% ddz_hand = -mu*z/(r^3) + (3*mu*R*R*J2*z/(2*(r^7)))*(5*z*z - 3*r*r) + (15*mu*R*R*C22*(x^2-y^2)*z/((x^2+y^2)*(r^7)))*(z^2 - r^2);

%%% Subbed to correct variables
ddx_hand = (-mu/r^3 + ((3*mu*R2n*R2n*J2s)/(2*r^5))*(5*z*z/(r^2) -1) + ((3*mu*R2n*R2n*C22s)/(((x-1+mu)^2+y^2)*r^3))*(2 - 2*((x-1+mu)^2-y^2)/((x-1+mu)^2+y^2) - (3*((x-1+mu)^2-y^2) + 2*z*z)/(r^2) + 2*z*z*((x-1+mu)^2-y^2)/(((x-1+mu)^2+y^2)*r*r) + (5*z*z*((x-1+mu)^2-y^2))/(r^4)))*(x-1+mu);
ddy_hand = (-mu/r^3 + ((3*mu*R2n*R2n*J2s)/(2*r^5))*(5*z*z/(r^2) -1) + ((3*mu*R2n*R2n*C22s)/(((x-1+mu)^2+y^2)*r^3))*(-2 - 2*((x-1+mu)^2-y^2)/((x-1+mu)^2+y^2) - (3*((x-1+mu)^2-y^2) - 2*z*z)/(r^2) + 2*z*z*((x-1+mu)^2-y^2)/(((x-1+mu)^2+y^2)*r*r) + (5*z*z*((x-1+mu)^2-y^2))/(r^4)))*y;
ddz_hand = -mu*z/(r^3) + (3*mu*R2n*R2n*J2s*z/(2*(r^7)))*(5*z*z - 3*r*r) + (15*mu*R2n*R2n*C22s*((x-1+mu)^2-y^2)*z/(((x-1+mu)^2+y^2)*(r^7)))*(z^2 - r^2);


%%% Deleting all terms without C22
% ddx_hand = (  ((3*mu*R2n*R2n*C22s)/(((x-1+mu)^2+y^2)*r^3))*(2 - 2*((x-1+mu)^2-y^2)/((x-1+mu)^2+y^2) - (3*((x-1+mu)^2-y^2) + 2*z*z)/(r^2) + 2*z*z*((x-1+mu)^2-y^2)/(((x-1+mu)^2+y^2)*r*r) + (5*z*z*((x-1+mu)^2-y^2))/(r^4)))*(x-1+mu);
% % ddy_hand = (-mu/r^3 + ((3*mu*R2n*R2n*J2s)/(2*r^5))*(5*z*z/(r^2) -1) + ((3*mu*R2n*R2n*C22s)/(((x-1+mu)^2+y^2)*r^3))*(-2 - 2*((x-1+mu)^2-y^2)/((x-1+mu)^2+y^2) - (3*((x-1+mu)^2-y^2) - 2*z*z)/(r^2) + 2*z*z*((x-1+mu)^2-y^2)/(((x-1+mu)^2+y^2)*r*r) + (5*z*z*((x-1+mu)^2-y^2))/(r^4)))*y;
% % ddz_hand = -mu*z/(r^3) + (3*mu*R2n*R2n*J2s*z/(2*(r^7)))*(5*z*z - 3*r*r) + (15*mu*R2n*R2n*C22s*((x-1+mu)^2-y^2)*z/(((x-1+mu)^2+y^2)*(r^7)))*(z^2 - r^2);







%%% Still has primary terms in it
% xdd =   ((2*mu + 2*x)*(mu - 1))/(2*((mu + x)^2 + y^2 + z^2)^(3/2)) - (mu*(2*mu + 2*x - 2))/(2*((mu + x - 1)^2 + y^2 + z^2)^(3/2)) + (J2s*R2n^2*mu*(2*mu + 2*x - 2))/(2*((mu + x - 1)^2 + y^2 + z^2)^(5/2)) - (5*J2s*R2n^2*mu*(2*mu + 2*x - 2)*((mu + x - 1)^2 + y^2 - 2*z^2))/(4*((mu + x - 1)^2 + y^2 + z^2)^(7/2)) - (3*C22s*R2n^2*mu*(z^2/((mu + x - 1)^2 + y^2 + z^2) - 1)*(2*mu + 2*x - 2))/(((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(3/2)) + (3*C22s*R2n^2*mu*z^2*((mu + x - 1)^2 - y^2)*(2*mu + 2*x - 2))/(((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(7/2)) + (3*C22s*R2n^2*mu*((mu + x - 1)^2 - y^2)*(z^2/((mu + x - 1)^2 + y^2 + z^2) - 1)*(2*mu + 2*x - 2))/(((mu + x - 1)^2 + y^2)^2*((mu + x - 1)^2 + y^2 + z^2)^(3/2)) + (9*C22s*R2n^2*mu*((mu + x - 1)^2 - y^2)*(z^2/((mu + x - 1)^2 + y^2 + z^2) - 1)*(2*mu + 2*x - 2))/(2*((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(5/2));
% ydd = -(mu*y)/((mu + x - 1)^2 + y^2 + z^2)^(3/2) + (y*(mu - 1))/((mu + x)^2 + y^2 + z^2)^(3/2) + (J2s*R2n^2*mu*y)/((mu + x - 1)^2 + y^2 + z^2)^(5/2) - (5*J2s*R2n^2*mu*y*((mu + x - 1)^2 + y^2 - 2*z^2))/(2*((mu + x - 1)^2 + y^2 + z^2)^(7/2)) + (6*C22s*R2n^2*mu*y*(z^2/((mu + x - 1)^2 + y^2 + z^2) - 1))/(((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(3/2)) + (6*C22s*R2n^2*mu*y*((mu + x - 1)^2 - y^2)*(z^2/((mu + x - 1)^2 + y^2 + z^2) - 1))/(((mu + x - 1)^2 + y^2)^2*((mu + x - 1)^2 + y^2 + z^2)^(3/2)) + (9*C22s*R2n^2*mu*y*((mu + x - 1)^2 - y^2)*(z^2/((mu + x - 1)^2 + y^2 + z^2) - 1))/(((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(5/2)) + (6*C22s*R2n^2*mu*y*z^2*((mu + x - 1)^2 - y^2))/(((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(7/2));
% zdd = (z*(mu - 1))/((mu + x)^2 + y^2 + z^2)^(3/2) - (mu*z)/((mu + x - 1)^2 + y^2 + z^2)^(3/2) - (2*J2s*R2n^2*mu*z)/((mu + x - 1)^2 + y^2 + z^2)^(5/2) - (5*J2s*R2n^2*mu*z*((mu + x - 1)^2 + y^2 - 2*z^2))/(2*((mu + x - 1)^2 + y^2 + z^2)^(7/2)) + (3*C22s*R2n^2*mu*((mu + x - 1)^2 - y^2)*((2*z^3)/((mu + x - 1)^2 + y^2 + z^2)^2 - (2*z)/((mu + x - 1)^2 + y^2 + z^2)))/(((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(3/2)) + (9*C22s*R2n^2*mu*z*((mu + x - 1)^2 - y^2)*(z^2/((mu + x - 1)^2 + y^2 + z^2) - 1))/(((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(5/2));

%%% No primary terms
xdd = -(mu*(2*mu + 2*x - 2))/(2*((mu + x - 1)^2 + y^2 + z^2)^(3/2)) + (J2s*R2n^2*mu*(2*mu + 2*x - 2))/(2*((mu + x - 1)^2 + y^2 + z^2)^(5/2)) - (5*J2s*R2n^2*mu*(2*mu + 2*x - 2)*((mu + x - 1)^2 + y^2 - 2*z^2))/(4*((mu + x - 1)^2 + y^2 + z^2)^(7/2)) - (3*C22s*R2n^2*mu*(z^2/((mu + x - 1)^2 + y^2 + z^2) - 1)*(2*mu + 2*x - 2))/(((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(3/2)) + (3*C22s*R2n^2*mu*z^2*((mu + x - 1)^2 - y^2)*(2*mu + 2*x - 2))/(((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(7/2)) + (3*C22s*R2n^2*mu*((mu + x - 1)^2 - y^2)*(z^2/((mu + x - 1)^2 + y^2 + z^2) - 1)*(2*mu + 2*x - 2))/(((mu + x - 1)^2 + y^2)^2*((mu + x - 1)^2 + y^2 + z^2)^(3/2)) + (9*C22s*R2n^2*mu*((mu + x - 1)^2 - y^2)*(z^2/((mu + x - 1)^2 + y^2 + z^2) - 1)*(2*mu + 2*x - 2))/(2*((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(5/2));
ydd = -(mu*y)/((mu + x - 1)^2 + y^2 + z^2)^(3/2) + (J2s*R2n^2*mu*y)/((mu + x - 1)^2 + y^2 + z^2)^(5/2) - (5*J2s*R2n^2*mu*y*((mu + x - 1)^2 + y^2 - 2*z^2))/(2*((mu + x - 1)^2 + y^2 + z^2)^(7/2)) + (6*C22s*R2n^2*mu*y*(z^2/((mu + x - 1)^2 + y^2 + z^2) - 1))/(((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(3/2)) + (6*C22s*R2n^2*mu*y*((mu + x - 1)^2 - y^2)*(z^2/((mu + x - 1)^2 + y^2 + z^2) - 1))/(((mu + x - 1)^2 + y^2)^2*((mu + x - 1)^2 + y^2 + z^2)^(3/2)) + (9*C22s*R2n^2*mu*y*((mu + x - 1)^2 - y^2)*(z^2/((mu + x - 1)^2 + y^2 + z^2) - 1))/(((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(5/2)) + (6*C22s*R2n^2*mu*y*z^2*((mu + x - 1)^2 - y^2))/(((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(7/2));
zdd = -(mu*z)/((mu + x - 1)^2 + y^2 + z^2)^(3/2) - (2*J2s*R2n^2*mu*z)/((mu + x - 1)^2 + y^2 + z^2)^(5/2) - (5*J2s*R2n^2*mu*z*((mu + x - 1)^2 + y^2 - 2*z^2))/(2*((mu + x - 1)^2 + y^2 + z^2)^(7/2)) + (3*C22s*R2n^2*mu*((mu + x - 1)^2 - y^2)*((2*z^3)/((mu + x - 1)^2 + y^2 + z^2)^2 - (2*z)/((mu + x - 1)^2 + y^2 + z^2)))/(((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(3/2)) + (9*C22s*R2n^2*mu*z*((mu + x - 1)^2 - y^2)*(z^2/((mu + x - 1)^2 + y^2 + z^2) - 1))/(((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(5/2));


%%% Deleting all terms without C22
% xdd = -(3*C22s*R2n^2*mu*(z^2/((mu + x - 1)^2 + y^2 + z^2) - 1)*(2*mu + 2*x - 2))/(((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(3/2)) + (3*C22s*R2n^2*mu*z^2*((mu + x - 1)^2 - y^2)*(2*mu + 2*x - 2))/(((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(7/2)) + (3*C22s*R2n^2*mu*((mu + x - 1)^2 - y^2)*(z^2/((mu + x - 1)^2 + y^2 + z^2) - 1)*(2*mu + 2*x - 2))/(((mu + x - 1)^2 + y^2)^2*((mu + x - 1)^2 + y^2 + z^2)^(3/2)) + (9*C22s*R2n^2*mu*((mu + x - 1)^2 - y^2)*(z^2/((mu + x - 1)^2 + y^2 + z^2) - 1)*(2*mu + 2*x - 2))/(2*((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(5/2));
% % ydd = -(mu*y)/((mu + x - 1)^2 + y^2 + z^2)^(3/2) + (J2s*R2n^2*mu*y)/((mu + x - 1)^2 + y^2 + z^2)^(5/2) - (5*J2s*R2n^2*mu*y*((mu + x - 1)^2 + y^2 - 2*z^2))/(2*((mu + x - 1)^2 + y^2 + z^2)^(7/2)) + (6*C22s*R2n^2*mu*y*(z^2/((mu + x - 1)^2 + y^2 + z^2) - 1))/(((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(3/2)) + (6*C22s*R2n^2*mu*y*((mu + x - 1)^2 - y^2)*(z^2/((mu + x - 1)^2 + y^2 + z^2) - 1))/(((mu + x - 1)^2 + y^2)^2*((mu + x - 1)^2 + y^2 + z^2)^(3/2)) + (9*C22s*R2n^2*mu*y*((mu + x - 1)^2 - y^2)*(z^2/((mu + x - 1)^2 + y^2 + z^2) - 1))/(((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(5/2)) + (6*C22s*R2n^2*mu*y*z^2*((mu + x - 1)^2 - y^2))/(((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(7/2));
% % zdd = -(mu*z)/((mu + x - 1)^2 + y^2 + z^2)^(3/2) - (2*J2s*R2n^2*mu*z)/((mu + x - 1)^2 + y^2 + z^2)^(5/2) - (5*J2s*R2n^2*mu*z*((mu + x - 1)^2 + y^2 - 2*z^2))/(2*((mu + x - 1)^2 + y^2 + z^2)^(7/2)) + (3*C22s*R2n^2*mu*((mu + x - 1)^2 - y^2)*((2*z^3)/((mu + x - 1)^2 + y^2 + z^2)^2 - (2*z)/((mu + x - 1)^2 + y^2 + z^2)))/(((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(3/2)) + (9*C22s*R2n^2*mu*z*((mu + x - 1)^2 - y^2)*(z^2/((mu + x - 1)^2 + y^2 + z^2) - 1))/(((mu + x - 1)^2 + y^2)*((mu + x - 1)^2 + y^2 + z^2)^(5/2));



ddx_hand - xdd
ddy_hand - ydd
ddz_hand - zdd
