clear
clc
addpath('../../bin')

% ------------------------------------------------------------------------
%%% P3 Givens
% ------------------------------------------------------------------------
alt = 600; % km
i = 28.5*pi/180; % rads
m = 10900; % kg
u_E = 398600.4415; % km^3/s^2, Earth
r_E = 6378.1363; % km, Earth radius
J2 = 0.0010826269;
e = 0;

% ------------------------------------------------------------------------
%%% 3a
% ------------------------------------------------------------------------
fprintf('---------------- 3a ----------------\n')
a = r_E + alt; % km

RAANdot = -(3/2)*sqrt(u_E)*J2*(r_E^2)*cos(i)/(((1-e^2)^2)*(a^(7/2)));
deg = RAANdot*3600*24*180/pi

% ------------------------------------------------------------------------
%%% 3b
% ------------------------------------------------------------------------
fprintf('---------------- 3b ----------------\n')
r = alt + r_E; % km

v = sqrt(u_E/r) % km/s

dv = tand(-deg)*v

% ------------------------------------------------------------------------
%%% 3c
% ------------------------------------------------------------------------
fprintf('---------------- 3c ----------------\n')
RAANss = 360*pi/(180*365.25*24*3600); % rad/s

x = (3/2)*sqrt(u_E)*r_E*r_E*J2/(((1-e^2)^2)*(a^(7/2)));
iss = acos(-RAANss/x)*180/pi;

di = iss - 28.5;

dvss = sqrt(2*v*v - 2*v*v*cosd(di))

% ------------------------------------------------------------------------
%%% 3d
% ------------------------------------------------------------------------
fprintf('---------------- 3d ----------------\n')
t_sid = 23*3600 + 56*60 + 4.0905; % seconds in geosynch

a1 = r;
a_gs = (u_E*((t_sid/(2*pi))^2))^(1/3); % km, semimajor axis for geosynch

at = (a1 + a_gs)/2; % km

vc1 = v % km/s
vt1 = sqrt(2*u_E/a1 - u_E/at) % km/s
vt2 = sqrt(2*u_E/a_gs - u_E/at) % km/s
vc2 = sqrt(u_E/a_gs) % km/s

dv1 = vt1 - vc1
dv2 = vc2 - vt2

dvtotal = dv1 + dv2



















